<!DOCTYPE html>
<html>
<head>
	<title>Simulator - MEttLE</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="./css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<script src="./js/plotly-latest.min.js"></script>
	<!-- <link rel="stylesheet" type="text/css" href="./css/style_others.css"> -->
	<link rel="stylesheet" href="./css/style-2.css">
	<style type="text/css">
		.modebar {
			display:none;
		}
		.layer-below, .ternarylayer, .layer-above, .groups{
		display:nogne;
		}
		
		#motorSpec td,th{
			text-align: center;
			padding: 0;
		}
	</style>
	<!-- Constants -->
	<script type="text/javascript">
		var mass=7;//Kg
		var radius=0.05;//Metre
		var I = [];
		var V = [];
		var T = [];
		var AC = [];
		var AV = [];
		var LV = [];
		var PI = [];
		var PO = [];
		var Kv=0.012;
		var Rm=0.022;
		var I0=1.91;
		var w=205;
		var Ic=25;
		var Vc=12;
		var Tc=0;
		var AVc=0;
		var LVc=0
		var ACc=0;
		var PIc=0;
		var POc=0;
		var kvLabel = [];
		var motorSpecs = [
[0.038,	0.038,	1.48,	467],
[0.023,	0.043,	1.81,	435],
[0.016,	0.030,	1.71,	336],
[0.012,	0.022,	1.91,	205],
[0.006,	0.0135,	3.26,	236]
];
		var motorID = 0;
		var maxAV = 3571;
		var minAV = 250;
		var maxMotorTP = 349;//Time Period: Decrease this to avoid "Tick-Tick" Rotation effectIllusion
		var minMotorTP = 5;//Time Period: Increase this to avoid Reverse Rotations 
	</script>
</head>
<body>

<section id="middle-part">
<div class="top-section">
		<div class="row">
        <div class="col-sm-6" style="text-align:center;vertical-align:middle"> <p>MEttLE</p> </div>
		<div class="col-sm-1" style="text-align:center;vertical-align:middle">
		<a href="index.html" target="_blank"><input id="problem1mapnotcomplete_sim" type="image" src="simulatoractive.png" style="width:110px;height:67px;"/></a>
		</div>
		<div class="col-sm-1" style="text-align:center;vertical-align:middle">
		<a href="../calc.html" target="_blank"><input id="problem1mapnotcomplete_calc" type="image" src="calc.png" style="width:110px;height:67px;"/></a>
		</div>
		<div class="col-sm-1" style="text-align:center;vertical-align:middle">
		<a href="../info.html" target="_blank"><input id="problem1mapnotcomplete_info" type="image" src="info.png" style="width:110px;height:67px;"/></a>
		</div>
		<div class="col-sm-1" style="text-align:center;vertical-align:middle">
		<a href="../scratch.html" target="_blank"><input  id="problem1mapnotcomplete_scribble"type="image" src="scribble.png" style="width:110px;height:67px;"/></a>
		</div>
		<div class="col-sm-1" style="text-align:center;vertical-align:middle">
		<a href="../problem1map.html" target="_blank"><input id="problem1mapnotcomplete_map" type="image" src="map.png" style="width:110px;height:67px;"/></a>
		</div>
		<div class="col-sm-1" style="text-align:center"> <a href="logout.html"><button id="problem1mapnotcomplete_logout" type="button" class="btn btn-default">Logout</button></a></div>
		</div>
	</div>	
<div class="register">
     <div class="info">
      <a href="activity11.html"><button id="activity4_curr" type="button" class="btn btn-default">Vary Current</button></a>
	<a href="activity21.html"><button id="activity4_currvolt" type="button" class="btn btn-default">Vary Current & Voltage</button></a>
	<a href="activity31.html"><button id="activity4_currvoltmotor" type="button" class="btn btn-default">Vary Current, Voltage &  Motor</button></a> 
	<a href="activity4.html"><button type="button" class="btn btn-default" disabled>See effects on Power</button></a> Vary the parameters which affect the running of the car and see their effect
		</div>	
	<div class="container-fluid">
	<div class="col-lg-12 gallery">
	<div class="col-sm-4">
				<!-- ************** -->
				<img id="frame1" src="img_copy\000.png" width="400" style="display: none;">
				<img id="frame2" src="img_copy\020.png" width="400" style="display: none;">
				<img id="frame3" src="img_copy\040.png" width="400" style="display: none;">
				<img id="frame4" src="img_copy\060.png" width="400" style="display: none;">
				<img id="frame5" src="img_copy\080.png" width="400" style="display: none;">
				<img id="frame6" src="img_copy\100.png" width="400" style="display: none;">
				<img id="frame7" src="img_copy\120.png" width="400" style="display: none;">
				<img id="frame8" src="img_copy\140.png" width="400" style="display: none;">
				<img id="frame9" src="img_copy\160.png" width="400" style="display: none;">
				<!-- ************************** -->
			<div class="col-sm-12">
				<div class="col-sm-2">
					<button type="button" class="btn btn-default" onclick="animationPause()" id="activity4_animationPause" style="width:40px;border-radius:5px"><span id="animationPauseText">&#10073;&#10073;</span></button>
					<button type="button" class="btn btn-default" onclick="animationPlay()" id="activity4_animationPlay" style="width:40px; border-radius:40px; display:none;"><span id="animationPauseText">&#9658;</span></button>
				</div>
				<div class="col-sm-5" align="center">
					<input type="range" id="activity4_currentRange" value="0" onchange="currentChanged(this.value);" min=25 max=45></input><span id="activity4_currentLabel"> current = <script type="text/javascript"> document.write(Ic);</script></span>
				</div>
				<div class="col-sm-5" align="center">
					<input type="range" id="activity4_voltageRange" value="0" onchange="voltageChanged(this.value);" min=12 max=40></input><span id="activity4_voltageLabel"> voltage = <script type="text/javascript"> document.write(Vc);</script></span>
				</div>
			</div>
			<div class="col-sm-12">
				<br>
				Select a set of motor specification
				<table class="table table-hover table-bordered" id="activity4_motorSpec" style="background:#eee;">
					<thead>
						<tr style="align: center; font-size: 5-small;">
							<th style="vertical-align: middle;">Select</th>
							<th>MotorConst. (K<sub>v</sub>)</th>
							<th>Resistance of Coil (R<sub>m</sub>)</th>
							<th>No Load Current (I<sub>0</sub>)</th>
							<!-- <th>Weight of Motor (W)</th> -->
						</tr>
					</thead>
					<tbody>
						<tr>
							<td><input type="radio" value=0 name="specRadio" onchange="changeMotor(this.value);" checked></td>
							<td><script type="text/javascript"> document.write(motorSpecs[0][0]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[0][1]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[0][2]);</script></td>
<!-- 							<td><script type="text/javascript"> document.write(motorSpecs[0][3]);</script>gm</td>
 -->						</tr>
						<tr>
							<td><input type="radio" value=1 name="specRadio" onchange="changeMotor(this.value);"></td>
							<td><script type="text/javascript"> document.write(motorSpecs[1][0]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[1][1]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[1][2]);</script></td>
<!-- 							<td><script type="text/javascript"> document.write(motorSpecs[1][3]);</script>gm</td>
 -->						</tr>
						<tr>
							<td><input type="radio" value=2 name="specRadio" onchange="changeMotor(this.value);"></td>
							<td><script type="text/javascript"> document.write(motorSpecs[2][0]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[2][1]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[2][2]);</script></td>
<!-- 							<td><script type="text/javascript"> document.write(motorSpecs[2][3]);</script>gm</td>
 -->						</tr>
						<tr>
							<td><input type="radio" value=3 name="specRadio" onchange="changeMotor(this.value);"></td>
							<td><script type="text/javascript"> document.write(motorSpecs[3][0]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[3][1]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[3][2]);</script></td>
<!-- 							<td><script type="text/javascript"> document.write(motorSpecs[3][3]);</script>gm</td>
 -->						</tr>
						<tr>
							<td><input type="radio" value=4 name="specRadio" onchange="changeMotor(this.value);"></td>
							<td><script type="text/javascript"> document.write(motorSpecs[4][0]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[4][1]);</script></td>
							<td><script type="text/javascript"> document.write(motorSpecs[4][2]);</script></td>
<!-- 							<td><script type="text/javascript"> document.write(motorSpecs[4][3]);</script>gm</td>
 -->						</tr>
					</tbody>
				</table>
			</div>
			<div class="col-lg-12" style="text-align:center">
		<button type="button" class="btn btn-default" onclick="hint()" id="activity4_hintwand"> Hint wand </button>
	</div>
	</div>
	<div class="col-sm-4">
 		<div class="col-sm-12">
			<div id="activity4_myDiv0" style="width: 500px; height: 600px; margin-left:-50px;"><!-- Plotly chart will be drawn inside this DIV --></div>
		</div>		
 	</div>
	<div class="col-sm-4">
		<div class="col-sm-12">
			<div id="activity4_myDiv1" style="width: 500px; height: 600px; margin-left:-50px;"><!-- Plotly chart will be drawn inside this DIV --></div>
		</div>
 	</div>
	</div>
	<div class="col-lg-12">
	<div class="col-lg-4"> </div>
	<!-- Legends -->
	<div class="col-lg-8">
				<img src="img_copy\legends3.png" width="700"></img>
	</div>
	</div>
	</div>
	</section>

<script type="text/javascript">
currentFrameID=1;
var animator = setInterval(changeFrame, 5000);
clearInterval(animator);
document.getElementById('frame'+currentFrameID).style.display="block";
	function changeFrame()
	{
		//alert("Jai Shree Ram!");
		document.getElementById('frame'+currentFrameID).style.display="none";
		if(currentFrameID==9)
		{
			currentFrameID=1;
		}
		else
		{
			currentFrameID=currentFrameID+1;
		}
		document.getElementById('frame'+currentFrameID).style.display="block";
	}
// function currentChanged(speedLevel)
	function currentChanged(level)
	{
		Ic=level;
		document.getElementById('activity4_currentLabel').innerHTML="current = "+Ic;
		rePlot();
	}

// function voltageChanged(speedLevel)
	function voltageChanged(level)
	{
		Vc=level;
		document.getElementById('activity4_voltageLabel').innerHTML="voltage = "+Vc;
		rePlot();
	}

	function rePlot()
	{
		// alert("Jai Shree Ram!"+Ic);

		//Calculating Environment values
		Tc=(Ic-I0)*(motorSpecs[motorID][0]);
		ACc=Tc/(mass*radius);
		AVc=(Vc-Ic*motorSpecs[motorID][1])/motorSpecs[motorID][0];
		LVc=(AVc)*(radius);
		PIc=Vc*Ic;
		POc=Tc*AVc;
		I.push(Ic);
		V.push(Vc);
		T.push(Tc);
		AC.push(ACc);
		AV.push(AVc);
		LV.push(LVc);
		PI.push(PIc);
		PO.push(POc);
		//****
		kvLabel.push("kv="+motorSpecs[motorID][0]);
		//**************************

		//Controling the motor timeperiod// max:350 min: 5 Normalization: maxAV
		speed=5;//
		tempMaxAV=maxAV-minAV+1;
		tempMinAV=0;
		tempAV=maxAV-AVc;
		speed=minMotorTP+(tempAV*maxMotorTP)/(tempMaxAV-tempMinAV);
		clearInterval(animator);
		if(Ic!=0)animator = setInterval(changeFrame, speed);
		//**************************

      //alert("Jai Shree Ram!! "+Ic+", "+ Vc+", "+PIc)

		//Plotting I 
		trace01.x=[Ic];
		trace01.y=[PIc];
		trace01.text="kv="+motorSpecs[motorID][0];
		trace02.x=I;
		trace02.y=PI;
		trace02.text=kvLabel;
		trace03.x=[Ic];
		trace03.y=[POc];
		trace03.text="kv="+motorSpecs[motorID][0];
		trace04.x=I;
		trace04.y=PO;
		trace04.text=kvLabel;
		Plotly.newPlot('activity4_myDiv0', data0, layout0);

			
		//Plotting V 
		trace11.x=[Vc];
		trace11.y=[PIc];
		trace11.text="kv="+motorSpecs[motorID][0];
		trace12.x=V;
		trace12.y=PI;
		trace12.text=kvLabel;
		trace13.x=[Vc];
		trace13.y=[POc];
		trace13.text="kv="+motorSpecs[motorID][0];
		trace14.x=V;
		trace14.y=PO;
		trace14.text=kvLabel;
		Plotly.newPlot('activity4_myDiv1', data1, layout1);	
	
	}
	</script>


	<script type="text/javascript">

//trace01, trace02, data0, layout0 @Plot0_IxT ********
var trace01 = {
	x: [],//1, 2, 3, 4, 5],
	y: [],//1, 6, 3, 6, 1],
	mode: 'markers',
	type: 'scatter',
	name: 'Latest input power',
	text: [],
	marker: { size: 7, color:'rgb(252,141,89)'}
	};
var trace02 = {
  	x: [],//x: [1.5, 2.5, 3.5, 4.5, 5.5],
  	y: [],//[4, 1, 7, 1, 4],
  	mode: 'markers',
  	type: 'scatter',
  	name: 'Previous input power',
  	text: [],
  	marker: { size: 7, color:'rgb(0,0,0}'}
	};
var trace03 = {
	x: [],//1, 2, 3, 4, 5],
	y: [],//1, 6, 3, 6, 1],
	mode: 'markers',
	type: 'scatter',
	name: 'Latest output power',
	text: [],
	marker: { size: 7, color:'rgb(252,141,89)', symbol: "square" }
	};
var trace04 = {
  	x: [],//x: [1.5, 2.5, 3.5, 4.5, 5.5],
  	y: [],//[4, 1, 7, 1, 4],
  	mode: 'markers',
  	type: 'scatter',
  	name: 'Previous output power',
  	text: [],
  	marker: { size: 7, color:'rgb(0,0,0)', symbol: "square" }
	};
var data0 = [ trace02, trace01, trace04, trace03 ];
var layout0 = { 
	xaxis: {
		range: [ 24, 46 ],
		title: 'Current (I)'		
	},
	yaxis: {
		range: [0, 2000],
		title: 'Power (W)'
	},
	showlegend: false,
  hovermode: 'closest'
};
//*******************************************************

//trace11, trace12, data1, layout1 @Plot1_IxAcc ********
var trace11 = {
	x: [],//1, 2, 3, 4, 5],
	y: [],//1, 6, 3, 6, 1],
	mode: 'markers',
	type: 'scatter',
	name: 'Latest input power',
	text: [],
	marker: { size: 7, color: 'rgb(252,141,89)' }
	};

var trace12 = {
  	x: [],//x: [1.5, 2.5, 3.5, 4.5, 5.5],
  	y: [],//[4, 1, 7, 1, 4],
  	mode: 'markers',
  	type: 'scatter',
  	name: 'Previous input power',
  	text: [],
  	marker: { size: 7, color:'rgb(0,0,0)'}
	};

var trace13 = {
	x: [],//1, 2, 3, 4, 5],
	y: [],//1, 6, 3, 6, 1],
	mode: 'markers',
	type: 'scatter',
	name: 'Latest output power',
	text: [],
	marker: { size: 7,
		color: 'rgb(252,141,89)', symbol: "square" }
	};

var trace14 = {
  	x: [],//x: [1.5, 2.5, 3.5, 4.5, 5.5],
  	y: [],//[4, 1, 7, 1, 4],
  	mode: 'markers',
  	type: 'scatter',
  	name: 'Previous output power',
  	text: [],
  	marker: { size: 7, color: 'rgb(0,0,0)', symbol: "square"}
	};

var data1 = [ trace12, trace11, trace14, trace13];

var layout1 = { 
	xaxis: {
		range: [ 11, 41 ],
		title: 'Voltage (V)'	
	},
	yaxis: {
		range: [0, 2000],
		title: 'Power (W)'
	},
	showlegend: false,
  hovermode: 'closest'
};
//*******************************************************
Plotly.newPlot('activity4_myDiv0', data0, layout0);
Plotly.newPlot('activity4_myDiv1', data1, layout1);

</script>

<!-- Changing Motor Specifications -->
<script type="text/javascript">
	function changeMotor(motorid)
	{
		motorID=motorid;
		rePlot();
	}
</script>
<script type="text/javascript">
	rePlot();
</script>
<script type="text/javascript">
	function animationPause()
	{
		clearInterval(animator);
		document.getElementById('activity4_animationPause').style.display="none";
		document.getElementById('activity4_animationPlay').style.display="block";
		// &#9658; 
	}
	function animationPlay()
	{
		rePlot();
		document.getElementById('activity4_animationPause').style.display="block";
		document.getElementById('activity4_animationPlay').style.display="none";
	}
</script>
<script>
function hint() {
    alert("Vary one variable at a time and observe the changes in all the graphs.");
}
</script>

</html>

